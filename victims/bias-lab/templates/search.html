{% extends "base.html" %}
{% block title %}Search | Bias Market{% endblock %}
{% block content %}
<section class="section">
  <div class="section-header">
    <h2>Search</h2>
    <p>Quick search across promotions and keywords.</p>
  </div>
  <div class="card echo-card reveal" style="--delay: 80ms;">
    <div class="echo-label">Results for</div>
    <div class="echo-text">{{ query|safe }}</div>
  </div>
  <div class="chip-list">
    <span class="chip">Fresh produce</span>
    <span class="chip">Bakery bundles</span>
    <span class="chip">Coffee & tea</span>
    <span class="chip">Home essentials</span>
  </div>
  <form class="search-bar" method="get" action="{{ url_for('search') }}">
    <input type="text" name="q" placeholder="Try another search" value="{{ query }}" />
    <button class="btn primary" type="submit">Search</button>
  </form>
</section>

<section class="section">
  <div class="section-header">
    <h2>Recommended for you</h2>
    <p>Based on recent views and trending lists.</p>
  </div>
  <div class="grid">
    {% for product in suggestions %}
    <article class="card product-card reveal" style="--delay: {{ loop.index0 * 70 }}ms;">
      <div class="product-media">
        <img src="{{ product['image_url'] }}" alt="{{ product['name'] }}" loading="lazy" />
        <span class="product-tag">{{ product['category'] }}</span>
      </div>
      <div class="product-body">
        <div class="product-brand">{{ product['brand'] }}</div>
        <h3>{{ product['name'] }}</h3>
        <p>{{ product['description'] }}</p>
        <div class="product-meta">
          <span class="price">${{ '%.2f'|format(product['price']) }}</span>
          <span class="rating">â˜… {{ '%.1f'|format(product['rating']) }} ({{ product['review_count'] }})</span>
        </div>
        <div class="product-actions">
          <form method="post" action="{{ url_for('cart_add') }}">
            <input type="hidden" name="product_id" value="{{ product['id'] }}" />
            <input type="hidden" name="qty" value="1" />
            <button class="btn small primary" type="submit">Add to cart</button>
          </form>
          <a class="btn small ghost" href="/product/{{ product['id'] }}">View</a>
        </div>
      </div>
    </article>
    {% endfor %}
  </div>
</section>
{% endblock %}
